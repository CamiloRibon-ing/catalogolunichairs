<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
  <meta name="format-detection" content="telephone=no">
  <meta name="theme-color" content="#e06c9f">
  <title>Cat√°logo de Accesorios</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="icon" href="recursos/lunilogo.png">
  <!-- Librer√≠a AOS para animaciones de scroll -->
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css">
  <link href="https://fonts.googleapis.com/css2?family=Lobster&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <title>Luni | Hair accessoriesüéÄüåôüå∏</title>
  <style>
    /* Prevenir FOUC */
    .hero, #catalogo { opacity: 0; }
    .loaded .hero, .loaded #catalogo { opacity: 1; transition: opacity 0.3s; }
  </style>
</head>

<body>
    <!-- Indicador de estado de carga -->
    <div id="loading-status" class="loading-status" style="
        position: fixed; 
        top: 0; 
        left: 0; 
        right: 0; 
        background: #007bff; 
        color: white; 
        padding: 5px 15px; 
        text-align: center; 
        font-size: 12px; 
        z-index: 9999;
        display: block;
    ">
        üîÑ Inicializando sistema de facturaci√≥n...
    </div>

    <!-- HEADER PROFESIONAL -->
    <header class="main-header">
        <div class="header-content">
            <div class="logo-section">
                <img src="recursos/lunilogo.png" alt="Luni Logo" class="header-logo">
                <div class="brand-info">
                    <span class="brand-name">Luni Hair Clips</span>
                    <span class="brand-tagline">Accesorios Premium</span>
                </div>
            </div>
            
            <!-- Bot√≥n de login en la esquina superior derecha -->
            <div class="header-actions">
                <button id="header-login-btn" class="btn-login-header">
                    <i class="fas fa-sign-in-alt"></i>
                    <span class="btn-text">Iniciar Sesi√≥n</span>
                </button>
                
                <div id="user-menu" class="user-menu" style="display: none;">
                    <div class="user-info">
                        <div class="user-avatar">
                            <i class="fas fa-user-circle"></i>
                        </div>
                        <div class="user-details">
                            <span class="user-name" id="current-username">Admin</span>
                            <span class="user-role">Administrador</span>
                        </div>
                    </div>
                    <div class="user-actions">
                        <!-- El bot√≥n admin se a√±adir√° aqu√≠ din√°micamente -->
                        <button id="header-logout-btn" class="btn-logout-header">
                            <i class="fas fa-sign-out-alt"></i>
                            <span class="btn-text">Salir</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <nav class="header-nav">
                <a href="#hero" class="nav-link">Inicio</a>
                <a href="#catalogo" class="nav-link">Cat√°logo</a>
                <a href="#about" class="nav-link">Nosotros</a>
            </nav>
            
            <div class="mobile-menu-toggle" id="mobile-menu-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </header>

    <!-- PRELOADER -->
    <div id="preloader">
        <div class="preloader-logo">
            <img src="recursos/lunilogo.png" alt="">
        </div>
        <p>Cargando...</p>
    </div>

    <!-- SECCI√ìN DE INICIO -->
    <section class="hero" id="hero">
        <h1 data-aos="fade-up">‚ú® BIENVENIDO A LUNI HAIR CLIPS ‚ú®</h1>
        <p data-aos="fade-up" data-aos-delay="200">
            En Luni creemos que cada cabello es √∫nico y especial, lleno de historia y belleza. 
            Cada pinza de Luni est√° pensada en ti y dise√±ada especialmente para resaltar esa belleza.
            <br><br>
            Nuestras pinzas est√°n elaboradas con acetato y resina de alta calidad, 
            lo que garantiza que no maltraten ni partan tu cabello, manteni√©ndolo perfectamente sujetado.
            <br><br>
            M√°s que simples pinzas, nuestros hair clips brindan <strong>comodidad, estilo, 
            autenticidad y seguridad</strong>, ideales para acompa√±arte en cualquier momento. ‚ú®
        </p>
        <a href="#catalogo" class="btn" data-aos="fade-up" data-aos-delay="400">Ver Cat√°logo</a>
    </section>

    <!-- CAT√ÅLOGO -->
    <section id="catalogo">
        <h2 data-aos="fade-up">Cat√°logo</h2>

        <!-- FILTROS DIN√ÅMICOS -->
        <div class="filters" data-aos="fade-up" id="category-filters">
            <!-- Los filtros se cargan din√°micamente desde la base de datos -->
        </div>

        <!-- GRID DE PRODUCTOS (se renderiza din√°micamente) -->
        <div class="product-grid">
            <!-- Los productos se cargar√°n din√°micamente desde el sistema de gesti√≥n -->
        </div>
    </section>



    <!-- <section>
<img src="recursos/agradecimientos.png" alt="">
<P>Gracias por llegar hasta aqui </P>
    <P>espero hayas disfrutado ver nuestro
      c√°talogo  y recuerda que tu apoyo
     hace brillar este sue√±o.</P>
  </section> -->

    <!-- FOOTER -->
    <footer>
        <p>üìç Luni Hairs lLips - Contacto: 304 495 2240</p>

        <div class="social-icons">
            <a href="https://wa.me/573044952240" target="_blank" aria-label="WhatsApp">
                <i class="fab fa-whatsapp"></i>
            </a>
            <a href="https://www.instagram.com/luni_hairclips?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw=="
                target="_blank" aria-label="Instagram">
                <i class="fab fa-instagram"></i>
            </a>
            <!-- <a href="https://www.facebook.com/share/1A2YYmo2e3/" target="_blank" aria-label="Facebook">
      <i class="fab fa-facebook"></i>
    </a> -->
        </div>

        <!-- M√©todos de pago -->
        <div class="metodos-pago">
            <div class="pago">
                <img src="recursos/Nequilogo.png" alt="Nequi Logo">
                <span><strong>Nequi:</strong> 304 495 2240</span>
            </div>
            <!-- <div class="pago">
      <img src="recursos/lobancolombia.png" alt="Bancolombia Logo">
      <span><strong>Bancolombia:</strong> 39878846650</span>
    </div> -->
        </div>
    </footer>


    <!-- ===== BOT√ìN FLOTANTE NEQUI ===== -->
    <div class="floating-buttons">
        <div class="floating-btn nequi" id="btn-nequi">
            <img src="recursos/Nequilogo.png" alt="Nequi">
            <span class="tooltip">Paga desde Nequi</span>
        </div>
        <!-- Bot√≥n flotante Bancolombia -->
        <!-- <div class="floating-btn bancolombia" id="btn-bancolombia">
  <img src="recursos/lobancolombia.png" alt="Bancolombia">
  <span class="tooltip">Paga desde Bancolombia</span>
</div> -->
        <a href="https://wa.me/573044952240" target="_blank" class="floating-btn whatsapp">
            <i class="fab fa-whatsapp"></i>
            <span class="tooltip">Contactanos</span>
        </a>
        <a href="https://www.instagram.com/luni_hairclips?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw=="
            target="_blank" class="floating-btn instagram">
            <i class="fab fa-instagram"></i>
            <span class="tooltip">Conoce mas sobre Nosotros</span>
        </a>
        <!-- <a href="https://www.facebook.com/share/1A2YYmo2e3/" target="_blank" class="floating-btn facebook">
    <i class="fab fa-facebook-f"></i>
    <span class="tooltip">Conoce mas sobre nosotros</span>
  </a> -->
    </div>


    <!-- ===== MODAL QR ===== -->
    <div class="modal" id="nequiModal">
        <div class="modal-content">
            <button class="modal-close-btn" id="closeModal">
                <i class="fas fa-times"></i>
            </button>
            <h2>Paga con Nequi</h2>
            <img src="recursos/Nequilogo.png" alt="QR Nequi">
            <p><strong>Nequi:</strong> 304 495 2240</p>
        </div>

    </div>
    <!-- 
<div class="modal" id="bancoModal">
  <div class="modal-content">
    <span class="close" id="closeBanco">&times;</span>
    <h2>Paga con Bancolombia</h2>
    <img src="recursos/lobancolombia.png" alt="Bancolombia Logo">
    <p><strong>Bancolombia:</strong> 39878846650</p>
  </div>
</div> -->

    <!-- ===== MODAL CARRITO ===== -->
    <div class="modal" id="cart-modal">
        <div class="modal-content cart-modal-content">
            <button class="modal-close-btn" id="close-cart">
                <i class="fas fa-times"></i>
            </button>
            <h2>üõí Tu Carrito</h2>
            <div id="cart-items" class="cart-items"></div>
            <div class="cart-footer">
                <div class="cart-total">
                    <strong>Total: <span id="cart-total">$0</span></strong>
                </div>
                <button id="checkout-btn" class="btn btn-checkout">Proceder al Checkout</button>
            </div>
        </div>
    </div>

    <!-- ===== MODAL CHECKOUT ===== -->
    <div class="modal" id="checkout-modal">
        <div class="modal-content checkout-modal-content">
            <button class="modal-close-btn" id="close-checkout">
                <i class="fas fa-times"></i>
            </button>
            <div class="checkout-header">
                <h2><i class="fas fa-shipping-fast"></i> Informaci√≥n de Env√≠o</h2>
                <p>Completa tus datos para procesar tu pedido</p>
            </div>
            <form id="customer-form" class="customer-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="customer-name">
                            <i class="fas fa-user"></i> Nombre Completo *
                        </label>
                        <input type="text" id="customer-name" required placeholder="Ej: Mar√≠a Garc√≠a">
                    </div>
                    <div class="form-group">
                        <label for="customer-phone">
                            <i class="fas fa-phone"></i> Tel√©fono *
                        </label>
                        <input type="tel" id="customer-phone" required placeholder="Ej: 3001234567">
                    </div>
                </div>
                <div class="form-group">
                    <label for="customer-email">
                        <i class="fas fa-envelope"></i> Email (opcional)
                    </label>
                    <input type="email" id="customer-email" placeholder="Ej: maria@ejemplo.com">
                </div>
                <div class="form-group">
                    <label for="customer-address">
                        <i class="fas fa-map-marker-alt"></i> Direcci√≥n *
                    </label>
                    <textarea id="customer-address" required rows="2" placeholder="Direcci√≥n completa"></textarea>
                </div>
                <div class="form-group">
                    <label for="customer-city">
                        <i class="fas fa-city"></i> Ciudad *
                    </label>
                    <input type="text" id="customer-city" required placeholder="Ej: Bogot√°">
                </div>
                <button type="button" id="send-whatsapp-btn" class="btn btn-whatsapp">
                    <i class="fab fa-whatsapp"></i> Enviar Pedido por WhatsApp
                </button>
            </form>
        </div>
    </div>

    <!-- ===== MODAL PANEL ADMIN ===== -->
    <div class="modal" id="admin-modal">
        <div class="modal-content admin-modal-content">
            <button class="modal-close-btn" id="admin-close">
                <i class="fas fa-times"></i>
            </button>
            <div class="admin-header">
                <div>
                    <h2><i class="fas fa-cog"></i> Panel de Administraci√≥n</h2>
                    <p>Gestiona tu cat√°logo de productos</p>
                </div>
                <button id="admin-logout" class="btn-logout" title="Cerrar Sesi√≥n">
                    <i class="fas fa-sign-out-alt"></i> Salir
                </button>
            </div>
            
            <div class="admin-tabs">
                <button class="admin-tab active" data-tab="dashboard" onclick="showAdminTab('dashboard')">
                    <i class="fas fa-chart-line"></i> Dashboard
                </button>
                <button class="admin-tab" data-tab="orders" onclick="showAdminTab('orders')">
                    <i class="fas fa-shopping-bag"></i> Ventas
                </button>
                <button class="admin-tab" data-tab="categories" onclick="showAdminTab('categories')">
                    <i class="fas fa-folder"></i> Categor√≠as
                </button>
                <button class="admin-tab" data-tab="products" onclick="showAdminTab('products')">
                    <i class="fas fa-box"></i> Productos
                </button>
                <button class="admin-tab" data-tab="add-product" onclick="showAdminTab('add-product')">
                    <i class="fas fa-plus-circle"></i> Agregar Producto
                </button>
            </div>

            <div class="admin-content">

            <!-- TAB DASHBOARD/ESTAD√çSTICAS -->
            <div id="admin-dashboard-tab" class="admin-tab-content active">
                <h3><i class="fas fa-chart-line"></i> Dashboard de Estad√≠sticas</h3>
                
                <!-- Estad√≠sticas generales -->
                <div class="stats-cards">
                    <div class="stat-card">
                        <div class="stat-icon revenue">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="stat-info">
                            <h4>Ingresos Totales</h4>
                            <p class="stat-value" id="stat-total-revenue">$0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon orders">
                            <i class="fas fa-shopping-bag"></i>
                        </div>
                        <div class="stat-info">
                            <h4>Pedidos Confirmados</h4>
                            <p class="stat-value" id="stat-total-orders">0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon average">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <div class="stat-info">
                            <h4>Ticket Promedio</h4>
                            <p class="stat-value" id="stat-average-order">$0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon pending">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <h4>Pendientes</h4>
                            <p class="stat-value" id="stat-pending">0</p>
                        </div>
                    </div>
                </div>

                <!-- Gr√°ficas -->
                <div class="charts-grid">
                    <div class="chart-container">
                        <canvas id="top-products-chart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="status-pie-chart"></canvas>
                    </div>
                </div>

                <!-- Ventas por per√≠odo -->
                <div class="period-tabs">
                    <button class="period-tab active" onclick="changePeriodChart('day')">Por D√≠a</button>
                    <button class="period-tab" onclick="changePeriodChart('week')">Por Semana</button>
                    <button class="period-tab" onclick="changePeriodChart('month')">Por Mes</button>
                </div>
                <div class="chart-container full-width">
                    <canvas id="sales-day-chart"></canvas>
                </div>

                <!-- Productos con poco stock -->
                <div class="low-stock-section">
                    <h4><i class="fas fa-exclamation-triangle"></i> Productos con Poco Stock</h4>
                    <div id="low-stock-list" class="low-stock-list"></div>
                </div>
            </div>

            <!-- TAB VENTAS/PEDIDOS -->
            <div id="admin-orders-tab" class="admin-tab-content">
                <div class="tab-header">
                    <h3><i class="fas fa-shopping-bag"></i> Gesti√≥n de Ventas</h3>
                    <div class="orders-stats">
                        <div class="stat-item">
                            <span class="stat-label">Total:</span>
                            <span class="stat-value" id="orders-total">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Ingresos:</span>
                            <span class="stat-value" id="orders-revenue">$0</span>
                        </div>
                    </div>
                </div>
                <div class="orders-filters">
                    <!-- Botones de debug ocultos en producci√≥n -->
                    <!--
                    <button onclick="adminForceLocalStorage()" class="btn btn-debug" style="background: #ff6b6b; margin-right: 10px;">
                        <i class="fas fa-database"></i> DEBUG: Cargar LocalStorage
                    </button>
                    <button onclick="adminDebugDOM()" class="btn btn-info" style="background: #17a2b8; margin-right: 10px;">
                        <i class="fas fa-search"></i> DEBUG: Ver DOM
                    </button>
                    <button onclick="debugVisibility()" class="btn btn-warning" style="background: #ffc107; margin-right: 10px;">
                        <i class="fas fa-eye"></i> FORZAR VISIBILIDAD
                    </button>
                    <button onclick="debugInitialization()" class="btn btn-secondary" style="background: #6c757d; margin-right: 10px;">
                        <i class="fas fa-cogs"></i> DEBUG INIT
                    </button>
                    <button onclick="forceReinitialize()" class="btn btn-warning" style="background: #ffc107; color: #000; margin-right: 10px;">
                        <i class="fas fa-refresh"></i> REINICIALIZAR
                    </button>
                    -->
                    <button class="filter-status active" data-status="all" onclick="filterOrders('all')">Todos</button>
                    <button class="filter-status" data-status="pending" onclick="filterOrders('pending')">Pendientes</button>
                    <button class="filter-status" data-status="confirmed" onclick="filterOrders('confirmed')">Confirmados</button>
                    <button class="filter-status" data-status="preparing" onclick="filterOrders('preparing')">En Preparaci√≥n</button>
                    <button class="filter-status" data-status="shipped" onclick="filterOrders('shipped')">Enviados</button>
                    <button class="filter-status" data-status="delivered" onclick="filterOrders('delivered')">Entregados</button>
                    <button class="filter-status" data-status="cancelled" onclick="filterOrders('cancelled')">Cancelados</button>
                    <button class="filter-status" data-status="completed" onclick="filterOrders('completed')">Completados</button>
                </div>
                <div id="admin-orders-list" class="admin-orders-list"></div>
            </div>

            <!-- TAB CATEGOR√çAS -->
            <div id="admin-categories-tab" class="admin-tab-content">
                <div class="tab-header">
                    <h3><i class="fas fa-folder"></i> Gestionar Categor√≠as</h3>
                    <button id="admin-add-category" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Nueva Categor√≠a
                    </button>
                </div>
                <form id="category-form" class="category-form" style="display: none;">
                    <h4 id="category-form-title">Agregar Nueva Categor√≠a</h4>
                    <input type="hidden" id="category-id">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="category-name">Nombre de la Categor√≠a *</label>
                            <input type="text" id="category-name" required placeholder="Ej: Ganchitos">
                        </div>
                        <div class="form-group">
                            <label for="category-slug">Slug *</label>
                            <input type="text" id="category-slug" required placeholder="Ej: ganchitos">
                            <small>URL amigable (sin espacios, min√∫sculas)</small>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="category-icon">Icono (Emoji)</label>
                            <input type="text" id="category-icon" placeholder="üéÄ" maxlength="2">
                        </div>
                        <div class="form-group">
                            <label for="category-active">
                                <input type="checkbox" id="category-active" checked>
                                Categor√≠a Activa
                            </label>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="save-category-btn" class="btn btn-primary">Guardar Categor√≠a</button>
                        <button type="button" onclick="document.getElementById('category-form').style.display='none'" class="btn btn-secondary">Cancelar</button>
                    </div>
                </form>
                <div id="admin-categories-list" class="admin-categories-list"></div>
            </div>

            <!-- TAB PRODUCTOS -->
            <div id="admin-products-tab" class="admin-tab-content">
                <h3><i class="fas fa-box"></i> Gestionar Productos</h3>
                <div id="admin-products-list" class="admin-products-list"></div>
            </div>

            <!-- TAB AGREGAR PRODUCTO -->
            <div id="admin-add-product-tab" class="admin-tab-content">
                <h3 id="form-title"><i class="fas fa-plus-circle"></i> Agregar Nuevo Producto</h3>
                <form id="product-form" class="product-form" style="display: none;">
                    <input type="hidden" id="product-id">
                    
                    <div class="form-section">
                        <h4>Informaci√≥n B√°sica</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="product-name">Nombre del Producto *</label>
                                <input type="text" id="product-name" required placeholder="Ej: Orquidea">
                            </div>
                            <div class="form-group">
                                <label for="product-category">Categor√≠a *</label>
                                <select id="product-category" required>
                                    <option value="">Seleccione una categor√≠a</option>
                                </select>
                                <small>Debes crear categor√≠as primero</small>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="product-price">Precio *</label>
                                <input type="number" id="product-price" min="0" step="100" required placeholder="0">
                            </div>
                            <div class="form-group">
                                <label for="product-stock">Stock Disponible</label>
                                <input type="number" id="product-stock" min="0" value="0">
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h4>Caracter√≠sticas</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="product-color">Color</label>
                                <input type="text" id="product-color" placeholder="Ej: Rosa y crema">
                            </div>
                            <div class="form-group">
                                <label for="product-size">Tama√±o</label>
                                <select id="product-size">
                                    <option value="">Seleccione un tama√±o</option>
                                    <option value="Peque√±o">Peque√±o</option>
                                    <option value="Mediano">Mediano</option>
                                    <option value="Grande">Grande</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="product-description">Descripci√≥n</label>
                            <textarea id="product-description" rows="3" placeholder="Descripci√≥n del producto"></textarea>
                        </div>
                    </div>

                    <div class="form-section">
                        <h4>Im√°genes del Producto</h4>
                        <div class="multiple-images-container">
                            <!-- Imagen Principal -->
                            <div class="image-upload-container">
                                <h5><i class="fas fa-star"></i> Imagen Principal *</h5>
                                <div class="image-preview-wrapper">
                                    <img id="product-image-preview" src="recursos/lunilogo.png" alt="Preview">
                                    <div class="upload-progress-container">
                                        <div id="upload-progress" class="upload-progress"></div>
                                    </div>
                                </div>
                                <div class="upload-controls">
                                    <label for="product-image-input" class="btn btn-upload">
                                        <i class="fas fa-cloud-upload-alt"></i> Subir Imagen Principal
                                    </label>
                                    <input type="file" id="product-image-input" accept="image/*" style="display: none;">
                                    <small>Formatos: JPG, PNG, WEBP (m√°x. 5MB)</small>
                                </div>
                                <div class="form-group">
                                    <label for="product-image-url">URL de Imagen Principal (Cloudinary)</label>
                                    <input type="text" id="product-image-url" placeholder="Se llenar√° autom√°ticamente al subir">
                                </div>
                            </div>
                            
                            <!-- Im√°genes Adicionales -->
                            <div class="additional-images-container">
                                <h5><i class="fas fa-images"></i> Im√°genes Adicionales (Opcional)</h5>
                                <p class="help-text">Agrega hasta 4 im√°genes adicionales para mostrar diferentes √°ngulos del producto</p>
                                <div id="additional-images-list" class="additional-images-list">
                                    <!-- Las im√°genes adicionales aparecer√°n aqu√≠ -->
                                </div>
                                <button type="button" id="add-additional-image" class="btn btn-secondary">
                                    <i class="fas fa-plus"></i> Agregar Imagen Adicional
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <div class="form-group">
                            <label for="product-available">
                                <input type="checkbox" id="product-available" checked>
                                Producto Disponible
                            </label>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" id="save-product-btn" class="btn btn-primary">
                            <i class="fas fa-save"></i> Guardar Producto
                        </button>
                        <button type="button" onclick="adminPanel.cancelProductForm()" class="btn btn-secondary">Cancelar</button>
                    </div>
                </form>
            </div>
            </div> <!-- admin-content -->
        </div>
    </div>

    <!-- ===== BOT√ìN CARRITO FLOTANTE ===== -->
    <div class="cart-floating-btn" id="cart-btn" onclick="openCart()">
        <i class="fas fa-shopping-cart"></i>
        <span id="cart-count" class="cart-count"></span>
    </div>
    <!-- ===== MODAL PROFESIONAL DE DETALLES DEL PRODUCTO ===== -->
    <div class="modal" id="product-details-modal">
        <div class="modal-content professional-product-modal">
            <button class="modal-close-btn" onclick="closeProductModal()">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="professional-modal-container">
                <!-- Secci√≥n de Galer√≠a de Im√°genes (Izquierda) -->
                <div class="modal-gallery-section">
                    <div class="modal-image-container" id="modal-image-container">
                        <!-- Aqu√≠ se renderiza la galer√≠a din√°micamente -->
                    </div>
                </div>
                
                <!-- Secci√≥n de Informaci√≥n del Producto (Derecha) -->
                <div class="modal-info-section">
                    <div class="product-header">
                        <div class="product-badge">
                            <span id="modal-product-category" class="category-badge">Categor√≠a</span>
                            <div id="modal-stock-badge" class="stock-badge-new"></div>
                        </div>
                        <h1 id="modal-product-name" class="product-title">Nombre del Producto</h1>
                        <div class="product-rating">
                            <div class="stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <span class="rating-text">4.8 (1,221)</span>
                        </div>
                    </div>
                    
                    <div class="product-pricing">
                        <div class="price-container">
                            <span class="currency-symbol">$</span>
                            <span id="modal-product-price" class="main-price">0</span>
                        </div>
                    </div>
                    
                    <div class="product-specifications">
                        <h3>Especificaciones</h3>
                        <div class="specs-grid">
                            <div class="spec-item">
                                <i class="fas fa-palette"></i>
                                <span class="spec-label">Color:</span>
                                <span id="modal-product-color" class="spec-value">-</span>
                            </div>
                            <div class="spec-item">
                                <i class="fas fa-ruler"></i>
                                <span class="spec-label">Tama√±o:</span>
                                <span id="modal-product-size" class="spec-value">-</span>
                            </div>
                            <div class="spec-item">
                                <i class="fas fa-boxes"></i>
                                <span class="spec-label">Stock:</span>
                                <span id="modal-product-stock" class="spec-value">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="product-description-section">
                        <h3>Descripci√≥n del Producto</h3>
                        <div id="modal-product-description" class="description-content">
                            Descripci√≥n del producto
                        </div>
                    </div>
                    
                    <div class="product-actions-section">
                        <div class="quantity-section">
                            <label for="modal-quantity">Cantidad:</label>
                            <div class="quantity-controls-new">
                                <button type="button" onclick="changeModalQuantity(-1)" class="qty-btn-new">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <input type="number" id="modal-quantity" value="1" min="1" max="10" readonly>
                                <button type="button" onclick="changeModalQuantity(1)" class="qty-btn-new">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="action-buttons">
                            <button id="modal-add-to-cart" class="btn-add-to-cart-new" onclick="addToCartFromModal()">
                                <i class="fas fa-shopping-cart"></i>
                                Agregar al Carrito
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- SCRIPTS -->
   
    <script>
        // ===== INICIALIZACION INMEDIATA =====
        
        // Funci√≥n global para filtrar √≥rdenes (disponible inmediatamente)
        window.filterOrders = async function(status) {
            console.log('üîç Filtrando √≥rdenes por estado:', status);
            
            try {
                // Actualizar botones de filtro
                document.querySelectorAll('.filter-status').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                const activeBtn = document.querySelector(`.filter-status[data-status="${status}"]`);
                if (activeBtn) {
                    activeBtn.classList.add('active');
                    console.log('‚úÖ Bot√≥n de filtro activado:', status);
                }
                
                // Cargar √≥rdenes filtradas
                if (typeof adminPanel !== 'undefined' && adminPanel.loadOrdersList) {
                    await adminPanel.loadOrdersList(status);
                    adminPanel.updateOrdersStats();
                    console.log('‚úÖ √ìrdenes filtradas cargadas para estado:', status);
                } else {
                    console.warn('‚ö†Ô∏è adminPanel no disponible a√∫n, reintentando...');
                    // Reintentar despu√©s de un momento
                    setTimeout(() => {
                        if (typeof adminPanel !== 'undefined') {
                            adminPanel.loadOrdersList(status);
                            adminPanel.updateOrdersStats();
                        }
                    }, 1000);
                }
            } catch (error) {
                console.error('‚ùå Error filtrando √≥rdenes:', error);
                alert('Error filtrando √≥rdenes: ' + error.message);
            }
        };
        
        // Funci√≥n de debug para verificar estado de inicializaci√≥n
        window.debugInitialization = function() {
            const status = {
                invoiceGenerator: typeof window.invoiceGenerator !== 'undefined' && window.invoiceGenerator,
                initFunction: typeof window.initializeInvoiceGenerator !== 'undefined',
                adminPanel: typeof adminPanel !== 'undefined' && adminPanel,
                orderManager: typeof orderManager !== 'undefined' && orderManager,
                jsPDF: typeof window.jspdf !== 'undefined',
                supabaseClient: typeof supabaseClient !== 'undefined',
                invoiceGeneratorReady: window.invoiceGenerator?.isReady || false
            };
            
            console.log('üîç Estado de inicializaci√≥n completo:', status);
            
            let message = 'üîç DEBUG INICIALIZACI√ìN:\n\n';
            message += `üìã invoiceGenerator: ${status.invoiceGenerator ? '‚úÖ OK' : '‚ùå NO DISPONIBLE'}\n`;
            message += `‚öôÔ∏è initFunction: ${status.initFunction ? '‚úÖ OK' : '‚ùå NO DISPONIBLE'}\n`;
            message += `üéØ isReady: ${status.invoiceGeneratorReady ? '‚úÖ OK' : '‚ùå NO LISTO'}\n`;
            message += `üë®‚Äçüíº adminPanel: ${status.adminPanel ? '‚úÖ OK' : '‚ùå NO DISPONIBLE'}\n`;
            message += `üì¶ orderManager: ${status.orderManager ? '‚úÖ OK' : '‚ùå NO DISPONIBLE'}\n`;
            message += `üìÑ jsPDF: ${status.jsPDF ? '‚úÖ OK' : '‚ùå NO DISPONIBLE'}\n`;
            message += `üîó supabaseClient: ${status.supabaseClient ? '‚úÖ OK' : '‚ùå NO DISPONIBLE'}\n\n`;
            
            if (!status.invoiceGenerator && status.initFunction) {
                message += `üîÑ SOLUCI√ìN: Ejecutando inicializaci√≥n manual...\n`;
                try {
                    window.initializeInvoiceGenerator();
                    message += `‚úÖ Inicializaci√≥n ejecutada!\n`;
                } catch (error) {
                    message += `‚ùå Error en inicializaci√≥n: ${error.message}\n`;
                }
            }
            
            alert(message);
            return status;
        };
        
        console.log('‚úÖ Funci√≥n filterOrders inicializada globalmente');
    </script>
    
    <!-- ================= INICIALIZACI√ìN PRINCIPAL ================= -->
    <script>
        console.log('üì± Iniciando sistema de inicializaci√≥n...');
        
        // Variables globales para tracking de inicializaci√≥n
        let initializationStatus = {
            jsPDF: false,
            supabase: false,
            orderManager: false,
            adminPanel: false,
            invoiceGenerator: false,
            complete: false
        };
        
        // Funci√≥n para mostrar estado de carga
        function updateLoadingStatus() {
            const totalSteps = Object.keys(initializationStatus).length - 1; // -1 por 'complete'
            const completedSteps = Object.values(initializationStatus).filter(Boolean).length;
            const percentage = Math.round((completedSteps / totalSteps) * 100);
            
            console.log(`üîÑ Progreso de carga: ${percentage}%`, initializationStatus);
            
            // Actualizar indicador visual
            const loadingElement = document.getElementById('loading-status');
            if (loadingElement) {
                if (percentage < 100) {
                    loadingElement.textContent = `üîÑ Inicializando sistema... ${percentage}%`;
                    loadingElement.style.display = 'block';
                } else {
                    loadingElement.textContent = '‚úÖ Sistema listo!';
                    setTimeout(() => {
                        loadingElement.style.display = 'none';
                    }, 2000);
                }
            }
        }
        
        // Funci√≥n para marcar componente como cargado
        function markAsLoaded(component) {
            initializationStatus[component] = true;
            updateLoadingStatus();
            console.log(`‚úÖ ${component} cargado correctamente`);
            checkAllLoaded();
        }
        
        // Verificar cuando todo est√© listo
        function checkAllLoaded() {
            const allLoaded = Object.entries(initializationStatus)
                .filter(([key]) => key !== 'complete')
                .every(([, value]) => value);
                
            if (allLoaded && !initializationStatus.complete) {
                initializationStatus.complete = true;
                console.log('üéâ ¬°Todos los componentes cargados exitosamente!');
                
                // Disparar evento personalizado para notificar que todo est√° listo
                window.dispatchEvent(new CustomEvent('appFullyLoaded'));
            }
        }
        
        // Listener para cuando todo est√© completamente cargado
        window.addEventListener('appFullyLoaded', function() {
            console.log('üöÄ Aplicaci√≥n completamente inicializada y lista para usar');
            
            // Mostrar mensaje final y ocultar indicador
            const loadingElement = document.getElementById('loading-status');
            if (loadingElement) {
                loadingElement.textContent = '‚úÖ Sistema de facturaci√≥n listo!';
                loadingElement.style.background = '#28a745';
                setTimeout(() => {
                    loadingElement.style.display = 'none';
                }, 3000);
            }
        });

        // DOMContentLoaded principal
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üèÅ DOM cargado, iniciando componentes...');
            
            // Funci√≥n para verificar e inicializar componentes
            function initializeComponents() {
                // Verificar jsPDF
                if (typeof window.jspdf !== 'undefined') {
                    if (!initializationStatus.jsPDF) {
                        markAsLoaded('jsPDF');
                    }
                } else {
                    console.warn('‚ö†Ô∏è jsPDF no disponible a√∫n...');
                }
                
                // Verificar Supabase
                if (typeof supabaseClient !== 'undefined') {
                    if (!initializationStatus.supabase) {
                        markAsLoaded('supabase');
                    }
                }
                
                // Inicializar OrderManager
                if (typeof OrderManager !== 'undefined' && !initializationStatus.orderManager) {
                    try {
                        if (!window.orderManager) {
                            window.orderManager = new OrderManager();
                        }
                        markAsLoaded('orderManager');
                        console.log('üì¶ OrderManager inicializado');
                    } catch (error) {
                        console.error('‚ùå Error inicializando OrderManager:', error);
                    }
                }
                
                // Inicializar AdminPanel
                if (typeof AdminPanel !== 'undefined' && !initializationStatus.adminPanel) {
                    try {
                        if (!window.adminPanel) {
                            window.adminPanel = new AdminPanel();
                        }
                        markAsLoaded('adminPanel');
                        console.log('üë®‚Äçüíº AdminPanel inicializado');
                    } catch (error) {
                        console.error('‚ùå Error inicializando AdminPanel:', error);
                    }
                }
                
                // Inicializar InvoiceGenerator
                if (typeof window.initializeInvoiceGenerator === 'function' && !initializationStatus.invoiceGenerator) {
                    try {
                        window.initializeInvoiceGenerator();
                        markAsLoaded('invoiceGenerator');
                    } catch (error) {
                        console.error('‚ùå Error inicializando InvoiceGenerator:', error);
                    }
                }
            }
            
            // Inicializar inmediatamente
            initializeComponents();
            
            // Verificar peri√≥dicamente durante los primeros segundos
            let checkCount = 0;
            const checkInterval = setInterval(() => {
                initializeComponents();
                checkCount++;
                
                if (checkCount >= 10 || initializationStatus.complete) {
                    clearInterval(checkInterval);
                    console.log('üîö Finalizado proceso de inicializaci√≥n');
                }
            }, 500);
        });
        
        // Funci√≥n auxiliar para forzar reinicializaci√≥n si es necesario
        window.forceReinitialize = function() {
            console.log('üîÑ Forzando reinicializaci√≥n...');
            
            // Reiniciar status
            Object.keys(initializationStatus).forEach(key => {
                if (key !== 'complete') {
                    initializationStatus[key] = false;
                }
            });
            initializationStatus.complete = false;
            
            // Reinicializar InvoiceGenerator espec√≠ficamente
            if (typeof window.initializeInvoiceGenerator === 'function') {
                try {
                    window.initializeInvoiceGenerator();
                    console.log('‚úÖ InvoiceGenerator reinicializado');
                } catch (error) {
                    console.error('‚ùå Error reinicializando InvoiceGenerator:', error);
                }
            }
            
            return window.debugInitialization();
        };
        
        console.log('üéØ Sistema de inicializaci√≥n configurado');
    </script>

    <!-- ================= SUPABASE (OBLIGATORIO) ================= -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="js/env-config.js"></script>
<script src="js/supabaseClient.js"></script>

<!-- ================= LIBRER√çAS ================= -->
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- ================= SISTEMA ================= -->
<script src="js/auth.js"></script>
<script src="js/categories.js"></script>
<script src="js/products.js"></script>
<script src="js/cloudinary.js"></script>
<script src="js/cart.js"></script>
<script src="js/orders.js"></script>
<script src="js/invoice.js"></script>
<script src="js/checkout.js"></script>
<script src="js/statistics.js"></script>
<script src="js/test-orders-admin.js"></script>
<script src="js/admin.js"></script>
<script src="js/main.js"></script>

<!-- ================= VERCEL ================= -->
<script>
  window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
</script>
<!-- Script de Vercel comentado para desarrollo local -->
<!-- <script defer src="/_vercel/insights/script.js"></script> -->

</body>

</html>